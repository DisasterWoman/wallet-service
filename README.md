# üí∞ Wallet Service

**REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º–∏ –∫–æ—à–µ–ª—å–∫–∞–º–∏ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.**

[![Go](https://img.shields.io/badge/Go-1.24-blue)](https://go.dev/)
[![PostgreSQL](https://img.shields.io/badge/PostgreSQL-15-green)](https://www.postgresql.org/)
[![Docker](https://img.shields.io/badge/Docker-20.10-blue)](https://www.docker.com/)

---

## üìå –û –ø—Ä–æ–µ–∫—Ç–µ

–°–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º–∏ –∫–æ—à–µ–ª—å–∫–∞–º–∏:
- –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ (`DEPOSIT`) –∏ —Å–ø–∏—Å–∞–Ω–∏–µ (`WITHDRAW`) —Å—Ä–µ–¥—Å—Ç–≤.
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –±–∞–ª–∞–Ω—Å–∞.
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **1000+ RPS** –Ω–∞ –æ–¥–∏–Ω –∫–æ—à–µ–ª—ë–∫ (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å—Ç—Ä–æ–∫).

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- [Go 1.24+](https://go.dev/dl/)
- [Docker](https://www.docker.com/) + [Docker Compose](https://docs.docker.com/compose/)
- [PostgreSQL 15+](https://www.postgresql.org/) (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å Docker)

---

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

#### 1. –ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
```bash
git clone https://github.com/DisasterWoman/wallet-service.git
cd wallet-service

2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–∫–æ–ø–∏—Ä—É–π .env.example –≤ .env –∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏:
cp .env.example .env

3. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
 make start

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: http://localhost:8080
–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: localhost:5433

4. –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–±–µ–∑ Docker)
# –£–±–µ–¥–∏—Å—å, —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ
cp .env.local .env  # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç localhost:5433
make run

üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
–ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤:
make test-all
–û—Ç–¥–µ–ª—å–Ω—ã–µ –≥—Ä—É–ø–ø—ã —Ç–µ—Å—Ç–æ–≤:
make test-unit           # –ë—ã—Å—Ç—Ä—ã–µ unit —Ç–µ—Å—Ç—ã
make test-integration    # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å –ë–î
make test-load           # –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã (684+ RPS)
make test-e2e            # End-to-end —Ç–µ—Å—Ç—ã API
–ü—Ä–∏–º–µ—Ä –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
# 1000 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É –Ω–∞ –æ–¥–∏–Ω –∫–æ—à–µ–ª—ë–∫
make test-load

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤:
‚úÖ 684 RPS –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—è—Ö –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç race condition —á–µ—Ä–µ–∑ SELECT FOR UPDATE
‚úÖ –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –±–∞–ª–∞–Ω—Å–∞ –ø—Ä–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö


üê≥ Docker
–°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫:
make build          # –°–±–æ—Ä–∫–∞ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞
make start          # –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
make docker-run     # –¢–æ–ª—å–∫–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏:
make stop           # –û—Å—Ç–∞–Ω–æ–≤–∫–∞
make restart        # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
make logs           # –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
make status         # –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:
make db-shell       # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL

üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:
make dev            # –ó–∞–ø—É—Å–∫ –ë–î
make run            # –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
make test-unit      # –ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

–ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
sql
-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
CREATE TABLE wallets (
    id UUID PRIMARY KEY,
    balance BIGINT NOT NULL DEFAULT 0
);

–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–¥–æ—Ä–æ–≤—å—è:
curl http://localhost:8080/health
